---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-ini
  namespace: monitoring
  labels:
    app.kubernetes.io/name: grafana-ini
    app.kubernetes.io/component: grafana
data:
  # Grafana's main configuration file. To learn more about the configuration options available to you, 
  # consult https://grafana.com/docs/installation/configuration
  grafana.ini: |
    [analytics]
    check_for_updates = true
    [grafana_net]
    url = https://grafana.net
    [log]
    mode = console
    [paths]
    data = /var/lib/grafana/data
    logs = /var/log/grafana
    plugins = /var/lib/grafana/plugins
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-datasources
  namespace: monitoring
  labels:
    app.kubernetes.io/name: grafana-datasources
data:
  # A file that specifies data sources for Grafana to use to populate dashboards. 
  # To learn more about configuring this, consult https://grafana.com/docs/administration/provisioning/#datasources
  datasources.yaml: |
    apiVersion: 1
    datasources:
    - access: proxy
      isDefault: true
      name: prometheus
      type: prometheus
      url: http://prometheus-server:8080
      version: 1
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboardproviders
  namespace: monitoring
  labels:
    app.kubernetes.io/name: grafana-dashboardproviders
data:
  # A file that configures where Grafana should look for dashboards to load when starting up. 
  # To learn more, consult https://grafana.com/docs/administration/provisioning/#dashboards
  # By default, the `dashboards-configmap.yaml` ConfigMap will be mounted to `/var/lib/grafana/dashboards` which is referenced in this file.
  dashboardproviders.yaml: |
    apiVersion: 1
    providers:
    - disableDeletion: false
      editable: true
      folder: ""
      name: default
      options:
        path: /var/lib/grafana/dashboards
      orgId: 1
      type: file
---

# Dashboards generated using kubernetes-mixin (https://github.com/kubernetes-monitoring/kubernetes-mixin)
# Note that dashboards like the "Scheduler" dashboard have been omitted 
# due those components not being exposed on DigitalOcean Kubernetes. 
# To learn more about DigitalOcean Kubernetesâ€™s architecture, consult
# https://www.digitalocean.com/docs/kubernetes/overview/
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards-conf
  namespace: monitoring
  labels:
    app.kubernetes.io/name: grafana-dashboards-conf
    app.kubernetes.io/component: grafana
data:
  # JSON dashboards stored as ConfigMap values, where the ConfigMap key is the name of the dashboard file
  k8s_mathieu.json: |
  {"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":15,"iteration":1574888932670,"links":[],"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","fill":1,"fillGradient":0,"gridPos":{"h":8,"w":18,"x":0,"y":0},"id":8,"legend":{"avg":false,"current":false,"max":true,"min":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum (container_spec_cpu_shares{container_name!=\"POD\",image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname) / 1000","hide":true,"interval":"10s","legendFormat":"{{ kubernetes_io_hostname }} Limit","refId":"A"},{"expr":"sum(rate (container_cpu_usage_seconds_total{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[5m]) ) by (kubernetes_io_hostname) / 8 * 100","hide":false,"interval":"10s","legendFormat":"{{ kubernetes_io_hostname }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Node - CPU","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percent","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"activePatternIndex":-3,"datasource":"Prometheus","debug_mode":false,"defaultPattern":{"bgColors":"green|orange|red","bgColors_overrides":"0->green|2->red|1->yellow","clickable_cells_link":"","col_name":"_1_","decimals":2,"defaultBGColor":"","defaultTextColor":"green","delimiter":"|","displayTemplate":"_value_","enable_bgColor":false,"enable_bgColor_overrides":false,"enable_clickable_cells":false,"enable_textColor":false,"enable_textColor_overrides":false,"enable_time_based_thresholds":false,"enable_transform":false,"enable_transform_overrides":false,"filter":{"value_above":"","value_below":""},"format":"bytes","name":"Default Pattern","null_color":"darkred","null_textcolor":"black","null_value":"No data","pattern":"*","row_col_wrapper":"_","row_name":"_0_","textColors":"red|orange|green","textColors_overrides":"0->red|2->green|1->yellow","thresholds":"70,90","time_based_thresholds":[],"tooltipTemplate":"Series : _series_ <br/>Row Name : _row_name_ <br/>Col Name : _col_name_ <br/>Value : _value_","transform_values":"_value_|_value_|_value_","transform_values_overrides":"0->down|1->up","valueName":"current"},"default_title_for_rows":"Node","gridPos":{"h":12,"w":6,"x":18,"y":0},"hide_first_column":false,"hide_headers":false,"id":2,"non_matching_cells_color_text":"","options":{},"patterns":[{"bgColors":"green|orange|red","bgColors_overrides":"0->green|2->red|1->yellow","clickable_cells_link":"","col_name":"_1_","decimals":2,"defaultBGColor":"","defaultTextColor":"Green","delimiter":"|","displayTemplate":"_value_","enable_bgColor":false,"enable_bgColor_overrides":false,"enable_clickable_cells":false,"enable_textColor":false,"enable_textColor_overrides":false,"enable_time_based_thresholds":false,"enable_transform":false,"enable_transform_overrides":false,"filter":{"value_above":"","value_below":""},"format":"bytes","name":"Prometheus Bytes","null_color":"darkred","null_textcolor":"black","null_value":"No data","pattern":"Memory","row_col_wrapper":"_","row_name":"_0_","textColors":"red|orange|green","textColors_overrides":"0->red|2->green|1->yellow","thresholds":"70,90","time_based_thresholds":[],"tooltipTemplate":"Series : _series_ <br/>Row Name : _row_name_ <br/>Col Name : _col_name_ <br/>Value : _value_","transform_values":"_value_|_value_|_value_","transform_values_overrides":"0->down|1->up","valueName":"current"},{"bgColors":"green|orange|red","bgColors_overrides":"0->green|2->red|1->yellow","clickable_cells_link":"","col_name":"_1_","decimals":2,"defaultBGColor":"","defaultTextColor":"Green","delimiter":"|","displayTemplate":"_value_","enable_bgColor":false,"enable_bgColor_overrides":false,"enable_clickable_cells":false,"enable_textColor":false,"enable_textColor_overrides":false,"enable_time_based_thresholds":false,"enable_transform":false,"enable_transform_overrides":false,"filter":{"value_above":"","value_below":""},"format":"none","name":"Prometheus CPU","null_color":"darkred","null_textcolor":"black","null_value":"No data","pattern":"CPU","row_col_wrapper":"_","row_name":"_0_","textColors":"red|orange|green","textColors_overrides":"0->red|2->green|1->yellow","thresholds":"70,90","time_based_thresholds":[],"tooltipTemplate":"Series : _series_ <br/>Row Name : _row_name_ <br/>Col Name : _col_name_ <br/>Value : _value_","transform_values":"_value_|_value_|_value_","transform_values_overrides":"0->down|1->up","valueName":"current"}],"row_col_wrapper":"_","sorting_props":{"col_index":1,"direction":"desc"},"targets":[{"expr":"sum(rate (container_cpu_usage_seconds_total{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[5m]) ) by (kubernetes_io_hostname)","format":"time_series","hide":false,"instant":false,"intervalFactor":1,"legendFormat":"{{ kubernetes_io_hostname }} | CPU","refId":"A"},{"expr":"sum (avg_over_time (container_memory_working_set_bytes{container_name!=\"POD\",image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[5m])) by (kubernetes_io_hostname)","format":"time_series","hide":false,"instant":false,"legendFormat":"{{ kubernetes_io_hostname }} | Memory","refId":"B"},{"expr":"container_fs_usage_bytes{id=\"/\",device=\"/dev/nvme0n1p1\",kubernetes_io_hostname=~\"^$Node$\"}","format":"time_series","hide":false,"instant":false,"legendFormat":"{{ kubernetes_io_hostname }} | Disk","refId":"C"}],"timeFrom":null,"timeShift":null,"title":"Nodes Ressources - Used","type":"yesoreyeram-boomtable-panel"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","fill":1,"fillGradient":0,"gridPos":{"h":8,"w":18,"x":0,"y":8},"id":12,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum (container_spec_memory_limit_bytes{container_name!=\"POD\",image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname) ","hide":true,"legendFormat":"{{ kubernetes_io_hostname }} Limit","refId":"A"},{"expr":"sum (avg_over_time (container_memory_working_set_bytes{container_name!=\"POD\",image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[5m])) by (kubernetes_io_hostname) / 16000000000 * 100","format":"time_series","hide":false,"intervalFactor":1,"legendFormat":"{{ kubernetes_io_hostname }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Node - Memory","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"percent","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"activePatternIndex":-3,"datasource":"Prometheus","debug_mode":false,"defaultPattern":{"bgColors":"green|orange|red","bgColors_overrides":"0->green|2->red|1->yellow","clickable_cells_link":"","col_name":"_1_","decimals":2,"defaultBGColor":"","defaultTextColor":"green","delimiter":"|","displayTemplate":"_value_","enable_bgColor":false,"enable_bgColor_overrides":false,"enable_clickable_cells":false,"enable_textColor":false,"enable_textColor_overrides":false,"enable_time_based_thresholds":false,"enable_transform":false,"enable_transform_overrides":false,"filter":{"value_above":"","value_below":""},"format":"bytes","name":"Default Pattern","null_color":"darkred","null_textcolor":"black","null_value":"No data","pattern":"*","row_col_wrapper":"_","row_name":"_0_","textColors":"red|orange|green","textColors_overrides":"0->red|2->green|1->yellow","thresholds":"70,90","time_based_thresholds":[],"tooltipTemplate":"Series : _series_ <br/>Row Name : _row_name_ <br/>Col Name : _col_name_ <br/>Value : _value_","transform_values":"_value_|_value_|_value_","transform_values_overrides":"0->down|1->up","valueName":"current"},"default_title_for_rows":"Node","gridPos":{"h":12,"w":6,"x":18,"y":12},"hide_first_column":false,"hide_headers":false,"id":13,"non_matching_cells_color_text":"","options":{},"patterns":[{"bgColors":"green|orange|red","bgColors_overrides":"0->green|2->red|1->yellow","clickable_cells_link":"","col_name":"_1_","decimals":2,"defaultBGColor":"","defaultTextColor":"Green","delimiter":"|","displayTemplate":"_value_","enable_bgColor":false,"enable_bgColor_overrides":false,"enable_clickable_cells":false,"enable_textColor":false,"enable_textColor_overrides":false,"enable_time_based_thresholds":false,"enable_transform":false,"enable_transform_overrides":false,"filter":{"value_above":"","value_below":""},"format":"bytes","name":"Prometheus Bytes","null_color":"darkred","null_textcolor":"black","null_value":"No data","pattern":"Memory","row_col_wrapper":"_","row_name":"_0_","textColors":"red|orange|green","textColors_overrides":"0->red|2->green|1->yellow","thresholds":"70,90","time_based_thresholds":[],"tooltipTemplate":"Series : _series_ <br/>Row Name : _row_name_ <br/>Col Name : _col_name_ <br/>Value : _value_","transform_values":"_value_|_value_|_value_","transform_values_overrides":"0->down|1->up","valueName":"current"},{"bgColors":"green|orange|red","bgColors_overrides":"0->green|2->red|1->yellow","clickable_cells_link":"","col_name":"_1_","decimals":2,"defaultBGColor":"","defaultTextColor":"Green","delimiter":"|","displayTemplate":"_value_","enable_bgColor":false,"enable_bgColor_overrides":false,"enable_clickable_cells":false,"enable_textColor":false,"enable_textColor_overrides":false,"enable_time_based_thresholds":false,"enable_transform":false,"enable_transform_overrides":false,"filter":{"value_above":"","value_below":""},"format":"none","name":"Prometheus CPU","null_color":"darkred","null_textcolor":"black","null_value":"No data","pattern":"CPU","row_col_wrapper":"_","row_name":"_0_","textColors":"red|orange|green","textColors_overrides":"0->red|2->green|1->yellow","thresholds":"70,90","time_based_thresholds":[],"tooltipTemplate":"Series : _series_ <br/>Row Name : _row_name_ <br/>Col Name : _col_name_ <br/>Value : _value_","transform_values":"_value_|_value_|_value_","transform_values_overrides":"0->down|1->up","valueName":"current"}],"row_col_wrapper":"_","sorting_props":{"col_index":1,"direction":"desc"},"targets":[{"expr":"sum (container_spec_cpu_shares{container_name!=\"POD\",image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname) / 1000","format":"time_series","hide":false,"instant":false,"intervalFactor":1,"legendFormat":"{{ kubernetes_io_hostname }} | CPU","refId":"A"},{"expr":"sum (container_spec_memory_limit_bytes{container_name!=\"POD\",image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname)","format":"time_series","hide":false,"instant":false,"legendFormat":"{{ kubernetes_io_hostname }} | Memory","refId":"B"},{"expr":"container_fs_limit_bytes{id=\"/\",device=\"/dev/nvme0n1p1\",kubernetes_io_hostname=~\"^$Node$\"}","format":"time_series","hide":false,"instant":false,"legendFormat":"{{ kubernetes_io_hostname }} | Disk","refId":"C"}],"timeFrom":null,"timeShift":null,"title":"Nodes Ressources - Limit","type":"yesoreyeram-boomtable-panel"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","fill":1,"fillGradient":0,"gridPos":{"h":8,"w":18,"x":0,"y":16},"id":10,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"container_fs_usage_bytes{id=\"/\",device=\"/dev/nvme0n1p1\",kubernetes_io_hostname=~\"^$Node$\"} / container_fs_limit_bytes{id=\"/\",device=\"/dev/nvme0n1p1\",kubernetes_io_hostname=~\"^$Node$\"} * 100","legendFormat":"{{ instance }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Node - Disk","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"percent","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","fill":1,"fillGradient":0,"gridPos":{"h":9,"w":18,"x":0,"y":24},"id":15,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time (container_memory_working_set_bytes{container_name!=\"POD\",image!=\"\",name=~\"^k8s_.*\",namespace=~\"^$namespace$\"}[5m])","legendFormat":"{{ pod_name }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Pod - Memory","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":2,"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"activePatternIndex":-3,"datasource":"Prometheus","debug_mode":false,"defaultPattern":{"bgColors":"green|orange|red","bgColors_overrides":"0->green|2->red|1->yellow","clickable_cells_link":"","col_name":"_1_","decimals":2,"defaultBGColor":"","defaultTextColor":"green","delimiter":"|","displayTemplate":"_value_","enable_bgColor":false,"enable_bgColor_overrides":false,"enable_clickable_cells":false,"enable_textColor":false,"enable_textColor_overrides":false,"enable_time_based_thresholds":false,"enable_transform":false,"enable_transform_overrides":false,"filter":{"value_above":"","value_below":""},"format":"bytes","name":"Default Pattern","null_color":"darkred","null_textcolor":"black","null_value":"No data","pattern":"*","row_col_wrapper":"_","row_name":"_0_","textColors":"red|orange|green","textColors_overrides":"0->red|2->green|1->yellow","thresholds":"70,90","time_based_thresholds":[],"tooltipTemplate":"Series : _series_ <br/>Row Name : _row_name_ <br/>Col Name : _col_name_ <br/>Value : _value_","transform_values":"_value_|_value_|_value_","transform_values_overrides":"0->down|1->up","valueName":"current"},"default_title_for_rows":"Pod Name","gridPos":{"h":16,"w":6,"x":18,"y":24},"id":4,"options":{},"patterns":[{"bgColors":"green|orange|red","bgColors_overrides":"0->green|2->red|1->yellow","clickable_cells_link":"","col_name":"_1_","decimals":2,"defaultBGColor":"","defaultTextColor":"Green","delimiter":"|","displayTemplate":"_value_","enable_bgColor":false,"enable_bgColor_overrides":false,"enable_clickable_cells":false,"enable_textColor":false,"enable_textColor_overrides":false,"enable_time_based_thresholds":false,"enable_transform":false,"enable_transform_overrides":false,"filter":{"value_above":"","value_below":""},"format":"bytes","name":"Prometheus Bytes","null_color":"darkred","null_textcolor":"black","null_value":"No data","pattern":"Memory","row_col_wrapper":"_","row_name":"_0_","textColors":"red|orange|green","textColors_overrides":"0->red|2->green|1->yellow","thresholds":"70,90","time_based_thresholds":[],"tooltipTemplate":"Series : _series_ <br/>Row Name : _row_name_ <br/>Col Name : _col_name_ <br/>Value : _value_","transform_values":"_value_|_value_|_value_","transform_values_overrides":"0->down|1->up","valueName":"current"},{"bgColors":"green|orange|red","bgColors_overrides":"0->green|2->red|1->yellow","clickable_cells_link":"","col_name":"_1_","decimals":"4","defaultBGColor":"","defaultTextColor":"Green","delimiter":"|","displayTemplate":"_value_","enable_bgColor":false,"enable_bgColor_overrides":false,"enable_clickable_cells":false,"enable_textColor":false,"enable_textColor_overrides":false,"enable_time_based_thresholds":false,"enable_transform":false,"enable_transform_overrides":false,"filter":{"value_above":"","value_below":""},"format":"none","name":"Prometheus CPU","null_color":"darkred","null_textcolor":"black","null_value":"No data","pattern":"CPU","row_col_wrapper":"_","row_name":"_0_","textColors":"red|orange|green","textColors_overrides":"0->red|2->green|1->yellow","thresholds":"70,90","time_based_thresholds":[],"tooltipTemplate":"Series : _series_ <br/>Row Name : _row_name_ <br/>Col Name : _col_name_ <br/>Value : _value_","transform_values":"_value_|_value_|_value_","transform_values_overrides":"0->down|1->up","valueName":"current"}],"row_col_wrapper":"_","sorting_props":{"col_index":1,"direction":"desc"},"targets":[{"expr":"sum ( rate (container_cpu_usage_seconds_total{container!=\"POD\",image!=\"\",name=~\"^k8s_.*\",namespace=~\"^$namespace$\"}[5m])) by (pod_name)","legendFormat":"{{ pod_name }} | CPU","refId":"A"},{"expr":"sum (avg_over_time (container_memory_working_set_bytes{container!=\"POD\",image!=\"\",name=~\"^k8s_.*\",namespace=~\"^$namespace$\"}[5m])) by (pod_name)","legendFormat":"{{ pod_name }} | Memory","refId":"B"},{"expr":"sum (container_fs_usage_bytes{container_name!=\"POD\",image!=\"\",name=~\"^k8s_.*\",namespace=~\"^$namespace$\"}) by (pod_name)","legendFormat":"{{ pod_name }} | Disk","refId":"C"}],"timeFrom":null,"timeShift":null,"title":"Pod Panel","type":"yesoreyeram-boomtable-panel"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","fill":1,"fillGradient":0,"gridPos":{"h":7,"w":18,"x":0,"y":33},"id":17,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"container_fs_usage_bytes{container_name!=\"POD\",image!=\"\",name=~\"^k8s_.*\",namespace=~\"^$namespace$\"}","legendFormat":"{{ pod_name }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Pod - Disk","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":false,"schemaVersion":20,"style":"dark","tags":["EKS"],"templating":{"list":[{"allValue":".*","current":{"text":"All","value":"$__all"},"datasource":"Prometheus","definition":"label_values(kubernetes_io_hostname)","hide":0,"includeAll":true,"label":null,"multi":false,"name":"Node","options":[],"query":"label_values(kubernetes_io_hostname)","refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"auto":true,"auto_count":20,"auto_min":"2m","current":{"text":"auto","value":"$__auto_interval_interval"},"hide":2,"label":null,"name":"interval","options":[{"selected":true,"text":"auto","value":"$__auto_interval_interval"},{"selected":false,"text":"1m","value":"1m"},{"selected":false,"text":"10m","value":"10m"},{"selected":false,"text":"30m","value":"30m"},{"selected":false,"text":"1h","value":"1h"},{"selected":false,"text":"6h","value":"6h"},{"selected":false,"text":"12h","value":"12h"},{"selected":false,"text":"1d","value":"1d"},{"selected":false,"text":"7d","value":"7d"},{"selected":false,"text":"14d","value":"14d"},{"selected":false,"text":"30d","value":"30d"}],"query":"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d","refresh":2,"skipUrlSync":false,"type":"interval"},{"allValue":".*","current":{"text":"All","value":"$__all"},"datasource":"Prometheus","definition":"label_values(namespace)","hide":0,"includeAll":true,"label":null,"multi":false,"name":"namespace","options":[],"query":"label_values(namespace)","refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-15m","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"]},"timezone":"","title":"[EKS] Cluster Overview","uid":"-My3TwpZy","version":2}
  #k8s-cluster-rsrc-use.json: |
  #k8s-node-rsrc-use.json: |
  #k8s-resources-cluster.json: |
  #k8s-resources-namespace.json: |
  #k8s-resources-pod.json: |
  #k8s-resources-workload.json: |
  #k8s-resources-workloads-namespace.json: |
  #nodes.json: |
  #pods.json: |
  #statefulset.json: |
---
apiVersion: v1
kind: Service
metadata:
  name: grafana-service
  namespace: monitoring
  labels:
    k8s-app: grafana
    app.kubernetes.io/name: grafana
    app.kubernetes.io/component: grafana
spec:
  ports:
    # Routes port 80 to port 3000 of the Grafana StatefulSet Pods
    - name: http
      port: 80
      protocol: TCP
      targetPort: 3000
  selector:
    k8s-app: grafana

